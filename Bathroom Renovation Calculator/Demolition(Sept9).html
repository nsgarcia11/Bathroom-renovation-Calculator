import React, { useState, useEffect, useRef } from 'react';

// --- Helper Components ---

const ToggleSwitch = ({ label, isEnabled, onToggle }) => (
     <label className="flex items-center justify-between cursor-pointer p-3 bg-white rounded-lg border border-slate-200">
        <span className="text-sm font-semibold text-slate-700">{label}</span>
        <div className="relative">
            <input type="checkbox" checked={isEnabled} onChange={(e) => onToggle(e.target.checked)} className="sr-only peer" />
            <div className="w-11 h-6 bg-gray-200 rounded-full border-2 border-blue-300 peer peer-focus:ring-2 peer-focus:ring-blue-500 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 peer-checked:border-blue-600"></div>
        </div>
    </label>
);


// --- View Components ---

const DemolitionView = ({ demolitionChoices, setDemolitionChoices, debrisDisposal, setDebrisDisposal, isDemolitionFlatFee, setIsDemolitionFlatFee, flatFeeAmount, setFlatFeeAmount, flatFeeDescription, setFlatFeeDescription, demolitionNotes, setDemolitionNotes }) => {

    const [isScopeOpen, setIsScopeOpen] = useState(true);
    const [isNotesOpen, setIsNotesOpen] = useState(false);

    const handleChoiceChange = (field, value) => {
        setDemolitionChoices(prev => ({
            ...prev,
            [field]: value
        }));
    };
    
    const noteChips = [
        "+ Mold/Asbestos",
        "+ Moving plumbing/electrical",
        "+ Load-Bearing Wall",
        "+ Pre-Demo Photos",
        "+ Protect Finishes"
    ];

    const handleChipClick = (chipText) => {
        const textToAdd = chipText.substring(2); // Remove "+ "
        setDemolitionNotes(prev => prev ? `${prev}\n- ${textToAdd}: ` : `- ${textToAdd}: `);
    };

    return (
        <div className="space-y-6">
            <div className='pt-2'>
                <h2 className="text-[36px] font-bold text-slate-800 text-left">Demolition</h2>
            </div>
            
            <section className="space-y-4">
                <div className="bg-white rounded-xl p-4 space-y-3 shadow-sm">
                    <ToggleSwitch 
                        label="Charge Flat Fee for Demolition?" 
                        isEnabled={isDemolitionFlatFee === 'yes'} 
                        onToggle={(checked) => setIsDemolitionFlatFee(checked ? 'yes' : 'no')} 
                    />
                     <ToggleSwitch 
                         label="Dispose of all demolition debris?" 
                         isEnabled={debrisDisposal === 'yes'} 
                         onToggle={(checked) => setDebrisDisposal(checked ? 'yes' : 'no')} 
                     />
                    {isDemolitionFlatFee === 'yes' && (
                        <div className="space-y-3 pt-3 border-t border-slate-200">
                            <div>
                                <label className="block text-sm font-semibold text-slate-700 mb-1.5">Flat Fee Amount ($)</label>
                                <input 
                                    type="number" 
                                    value={flatFeeAmount} 
                                    onChange={(e) => setFlatFeeAmount(e.target.value)} 
                                    placeholder="e.g., 1500" 
                                    className="w-full p-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-semibold text-slate-700 mb-1.5">Whatâ€™s included in the flat fee?</label>
                                <textarea 
                                    value={flatFeeDescription} 
                                    onChange={(e) => setFlatFeeDescription(e.target.value)} 
                                    placeholder="e.g., Removal of all bathroom fixtures, flooring, and debris..." 
                                    className="w-full p-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                    rows="3"
                                ></textarea>
                            </div>
                        </div>
                    )}
                </div>

                {isDemolitionFlatFee === 'no' && (
                    <div className="bg-white rounded-xl shadow-sm">
                        <button onClick={() => setIsScopeOpen(!isScopeOpen)} className="w-full flex justify-between items-center p-4">
                            <h3 className="text-lg font-bold text-slate-800">Demolition Scope</h3>
                            <svg className={`w-5 h-5 text-blue-500 transition-transform ${isScopeOpen ? 'rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" /></svg>
                        </button>
                        {isScopeOpen && (
                            <div className="p-4 pt-2 space-y-3 border-t border-slate-200">
                                <ToggleSwitch label="Remove Flooring" isEnabled={demolitionChoices.removeFlooring === 'yes'} onToggle={(checked) => handleChoiceChange('removeFlooring', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Shower Wall" isEnabled={demolitionChoices.removeShowerWall === 'yes'} onToggle={(checked) => handleChoiceChange('removeShowerWall', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Shower Base" isEnabled={demolitionChoices.removeShowerBase === 'yes'} onToggle={(checked) => handleChoiceChange('removeShowerBase', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Stand Alone/Drop-in Tub" isEnabled={demolitionChoices.removeTub === 'yes'} onToggle={(checked) => handleChoiceChange('removeTub', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Vanity" isEnabled={demolitionChoices.removeVanity === 'yes'} onToggle={(checked) => handleChoiceChange('removeVanity', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Toilet" isEnabled={demolitionChoices.removeToilet === 'yes'} onToggle={(checked) => handleChoiceChange('removeToilet', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Accessories (mirror, towel bars, etc.)" isEnabled={demolitionChoices.removeAccessories === 'yes'} onToggle={(checked) => handleChoiceChange('removeAccessories', checked ? 'yes' : 'no')} />
                                <ToggleSwitch label="Remove Wall (Partial or Full)" isEnabled={demolitionChoices.removeWall === 'yes'} onToggle={(checked) => handleChoiceChange('removeWall', checked ? 'yes' : 'no')} />
                            </div>
                        )}
                    </div>
                )}
                
                 <div className="bg-white rounded-xl shadow-sm">
                        <button onClick={() => setIsNotesOpen(!isNotesOpen)} className="w-full flex justify-between items-center p-4">
                            <h3 className="text-lg font-bold text-slate-800">Notes</h3>
                            <svg className={`w-5 h-5 text-blue-500 transition-transform ${isNotesOpen ? 'rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" /></svg>
                        </button>
                        {isNotesOpen && (
                            <div className="p-4 pt-2 space-y-3 border-t border-slate-200">
                                <textarea 
                                    value={demolitionNotes}
                                    onChange={(e) => setDemolitionNotes(e.target.value)}
                                    placeholder="e.g., heavy mortar, mold, vent under floor" 
                                    className="w-full p-2.5 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                    rows="4"
                                ></textarea>
                                <div className="flex flex-wrap -m-1">
                                    {noteChips.map(chip => (
                                        <button 
                                            key={chip}
                                            onClick={() => handleChipClick(chip)}
                                            className="m-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold hover:bg-blue-200 transition-colors"
                                        >
                                            {chip}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
            </section>
        </div>
    );
};


const SuppliesView = ({ constructionMaterials, setConstructionMaterials, handleDeleteSupply }) => {
    
    const handleConstructionMaterialChange = (id, field, value) => {
        setConstructionMaterials(prev => prev.map(mat => mat.id === id ? { ...mat, [field]: value } : mat));
    };

    const handleAddCustomSupply = () => {
        setConstructionMaterials(prev => [
            ...prev,
            { id: `custom-supply-${Date.now()}`, name: '', quantity: '1', price: '', unit: 'each' }
        ]);
    };
    
    const total = constructionMaterials.reduce((sum, item) => sum + (parseFloat(item.quantity) || 0) * (parseFloat(item.price) || 0), 0);
    
    const renderMaterialItem = (material) => {
        return (
             <div key={material.id} className={`p-3 bg-white rounded-lg border ${material.color || 'border-slate-300'}`}>
                 <div className="flex items-center gap-2 mb-2">
                     <input 
                         type="text" 
                         value={material.name} 
                         onChange={(e) => handleConstructionMaterialChange(material.id, 'name', e.target.value)} 
                         placeholder="Supply Name" 
                         className="w-full p-1 text-slate-700 font-semibold border-b-2 bg-transparent border-slate-200 focus:border-blue-500"
                     />
                     <button onClick={() => handleDeleteSupply(material.id)} className="text-red-500 hover:text-red-700 p-1">
                         <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                     </button>
                 </div>
                 <div className="grid grid-cols-3 gap-3">
                     <div>
                         <label className="text-xs text-slate-500">Quantity</label>
                         <input type="number" value={material.quantity} onChange={(e) => handleConstructionMaterialChange(material.id, 'quantity', e.target.value)} placeholder="0" className="w-full p-2 text-center border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                     </div>
                      <div>
                         <label className="text-xs text-slate-500">Price/Unit ($)</label>
                         <input type="number" value={material.price} onChange={(e) => handleConstructionMaterialChange(material.id, 'price', e.target.value)} placeholder="0.00" className="w-full p-2 text-center border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                     </div>
                     <div>
                         <label className="text-xs text-slate-500">Total</label>
                          <p className="w-full p-2 text-center font-semibold text-slate-800">${((parseFloat(material.quantity) || 0) * (parseFloat(material.price) || 0)).toFixed(2)}</p>
                     </div>
                 </div>
             </div>
        );
    }

    return (
        <div className="space-y-5">
            <div className="flex justify-between items-center">
                <h2 className="text-2xl font-bold text-slate-800">Disposal & Supplies</h2>
                <p className="font-bold text-blue-600 text-lg">${total.toFixed(2)}</p>
            </div>
            
            <div className="space-y-3">
                <div className="bg-white rounded-xl p-3 space-y-3 shadow-sm">
                    {constructionMaterials.length > 0 ? constructionMaterials.map(m => renderMaterialItem(m)) : <p className="text-sm text-slate-500 text-center py-4">No supplies or disposal fees needed.</p>}
                     <button onClick={handleAddCustomSupply} className="w-full mt-2 flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-100 hover:bg-blue-200 text-blue-800 font-semibold rounded-lg transition-colors border border-blue-200">
                         <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                         Add Custom Supply
                     </button>
                </div>
            </div>
        </div>
    );
};

const LaborView = ({ laborItems, setLaborItems, flatFeeItems, setFlatFeeItems, handleAddLaborItem, handleLaborItemChange, handleDeleteLaborItem, handleAddFlatFeeItem, handleFlatFeeItemChange, handleDeleteFlatFeeItem, isDemolitionFlatFee }) => {
    const hourlyTotal = laborItems.reduce((sum, item) => sum + (parseFloat(item.hours) || 0) * (parseFloat(item.rate) || 0), 0);
    const flatFeeTotal = flatFeeItems.reduce((sum, item) => sum + (parseFloat(item.price) || 0), 0);
    const total = isDemolitionFlatFee === 'yes' ? flatFeeTotal : hourlyTotal;

    const renderLaborItem = (item) => {
        if (!item) return null;
        return (
            <div key={item.id} className={`p-3 rounded-lg border bg-white shadow-sm ${item.color || 'border-slate-200'}`}>
                <div className="flex items-center gap-2 mb-2">
                    <input type="text" value={item.name} onChange={(e) => handleLaborItemChange(item.id, 'name', e.target.value)} placeholder="Labor Task" className="w-full p-1 text-slate-700 font-semibold border-b-2 border-slate-200 focus:border-blue-500 focus:outline-none bg-transparent" />
                    <button onClick={() => handleDeleteLaborItem(item.id)} className="text-red-500 hover:text-red-700 p-1">
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                    </button>
                </div>
                <div className="grid grid-cols-3 gap-3">
                    <div>
                        <label className="text-xs text-slate-500">Hours</label>
                        <input type="number" value={item.hours} onChange={(e) => handleLaborItemChange(item.id, 'hours', e.target.value)} placeholder="0" className="w-full p-2 text-center border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    </div>
                     <div>
                        <label className="text-xs text-slate-500">Rate ($/hr)</label>
                        <input type="number" value={item.rate} onChange={(e) => handleLaborItemChange(item.id, 'rate', e.target.value)} placeholder="0" className="w-full p-2 text-center border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    </div>
                    <div>
                        <label className="text-xs text-slate-500">Total</label>
                         <p className="w-full p-2 text-center font-semibold text-slate-800">${((parseFloat(item.hours) || 0) * (parseFloat(item.rate) || 0)).toFixed(2)}</p>
                    </div>
                </div>
            </div>
        );
    }

    const renderFlatFeeItem = (item) => {
        const isDemoFee = item.id === 'flat-fee-demolition';
        return (
            <div key={item.id} className={`p-3 rounded-lg border shadow-sm ${isDemoFee ? 'bg-blue-50 border-blue-200' : 'bg-white border-slate-200'}`}>
                <div className="flex items-center gap-2 mb-2">
                    <input 
                        type="text" 
                        value={item.name} 
                        onChange={(e) => handleFlatFeeItemChange(item.id, 'name', e.target.value)} 
                        placeholder="Flat Fee Task" 
                        className="w-full p-1 text-slate-700 font-semibold border-b-2 border-slate-200 focus:border-blue-500 focus:outline-none bg-transparent" 
                        disabled={isDemoFee} // Disable editing for the auto-generated demolition fee
                    />
                    {!isDemoFee && (
                         <button onClick={() => handleDeleteFlatFeeItem(item.id)} className="text-red-500 hover:text-red-700 p-1">
                             <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                         </button>
                    )}
                </div>
                <div>
                    <label className="text-xs text-slate-500">Total ($)</label>
                    <input 
                        type="number" 
                        value={item.price} 
                        onChange={(e) => handleFlatFeeItemChange(item.id, 'price', e.target.value)} 
                        placeholder="0.00" 
                        className="w-full p-2 text-center border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                        disabled={isDemoFee} // Disable editing for the auto-generated demolition fee
                    />
                </div>
            </div>
        )
    };

    // Filter demolition tasks once and store the result
    const demolitionTasks = laborItems.filter(item => item && item.id.startsWith('lab-'));
    const customTasks = laborItems.filter(item => item && item.id.startsWith('custom-'));

    return (
        <div className="space-y-5">
            <h2 className="text-2xl font-bold text-slate-800 text-center">Labor</h2>
            <div className="space-y-3">
                <div className="flex justify-between items-baseline">
                    <h3 className="text-lg font-semibold text-slate-700">Labor Costs</h3>
                    <p className="font-bold text-blue-600 text-lg">${total.toFixed(2)}</p>
                </div>

                {isDemolitionFlatFee === 'yes' ? (
                    <div className="space-y-3 bg-white rounded-xl p-3 shadow-sm">
                        <h3 className="text-lg font-semibold text-slate-700 px-1">Flat Fee Tasks</h3>
                        {flatFeeItems.length > 0 ? flatFeeItems.map(renderFlatFeeItem) : <p className="text-sm text-slate-500 text-center py-4">No flat fee tasks added.</p>}
                        <button onClick={handleAddFlatFeeItem} className="w-full mt-2 flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-100 hover:bg-blue-200 text-blue-800 font-semibold rounded-lg transition-colors border border-blue-200">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                            Add Custom Flat Fee Task
                        </button>
                    </div>
                ) : (
                    <>
                        <div className="space-y-3 bg-white rounded-xl p-3 shadow-sm">
                            <h3 className="text-lg font-semibold text-slate-700 px-1">Demolition & Prep Tasks</h3>
                            {demolitionTasks.length > 0 ? 
                                demolitionTasks.map(renderLaborItem) :
                                <p className="text-sm text-slate-500 text-center py-4">No demolition tasks selected.</p>
                            }
                        </div>
                        
                        <div className="space-y-3 bg-white rounded-xl p-3 shadow-sm">
                            <h3 className="text-lg font-semibold text-slate-700 px-1">Custom Hourly Tasks</h3>
                            {customTasks.map(renderLaborItem)}
                            
                            <button onClick={handleAddLaborItem} className="w-full mt-2 flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-100 hover:bg-blue-200 text-blue-800 font-semibold rounded-lg transition-colors border border-blue-200">
                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                                Add Custom Hourly Task
                            </button>
                        </div>
                    </>
                )}
            </div>
        </div>
    );
};

const MoreView = ({ total, notes, setNotes }) => (
    <div className="space-y-6">
        <h2 className="text-2xl font-bold text-slate-800 text-center">More</h2>
        
        <section className="bg-white rounded-xl p-4 shadow-sm">
            <h3 className="text-lg font-semibold text-slate-700 mb-2">Total Estimated Cost</h3>
            <div className="bg-slate-100 rounded-xl p-6 text-center">
                <p className="text-sm font-semibold text-slate-600">TOTAL</p>
                <p className="text-4xl font-bold text-slate-800 mt-1">${total.toFixed(2)}</p>
            </div>
        </section>

        <section className="bg-white rounded-xl p-4 shadow-sm">
            <h3 className="text-lg font-semibold text-slate-700 mb-2">General Project Notes</h3>
            <div className="rounded-xl bg-slate-50 p-3 border border-slate-200">
                <textarea 
                    value={notes} 
                    onChange={(e) => setNotes(e.target.value)} 
                    placeholder="Add general project notes here..." 
                    className="w-full p-2.5 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    rows="6"
                ></textarea>
            </div>
        </section>
    </div>
);

// --- Placeholder Views ---
const PlaceholderView = ({ title }) => (
    <div className="text-center p-8">
        <h2 className="text-2xl font-bold text-slate-800">{title}</h2>
        <p className="text-slate-500 mt-2">This section is under construction.</p>
    </div>
);

const ShowerWallsView = () => <PlaceholderView title="Shower Walls" />;
const ShowerBaseView = () => <PlaceholderView title="Shower Base" />;
const FloorsView = () => <PlaceholderView title="Floors" />;
const FinishingsView = () => <PlaceholderView title="Finishings" />;
const StructuralView = () => <PlaceholderView title="Structural/Other" />;
const TradesView = () => <PlaceholderView title="Trades" />;


// --- Navigation Components ---
const TopNavBar = ({ activeView, setActiveView }) => {
    const navItems = [
        { id: 'demolition', label: 'Demolition', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><path d="m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9"/><path d="m18 15 4-4"/><path d="m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5"/></svg> },
        { id: 'shower_walls', label: 'Shower Walls', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><path d="m4 4 2.5 2.5"/><path d="M13.5 6.5a4.95 4.95 0 0 0-7 7"/><path d="M15 5 5 15"/><path d="M14 17v.01"/><path d="M10 16v.01"/><path d="M13 13v.01"/><path d="M16 10v.01"/><path d="M11 20v.01"/><path d="M17 14v.01"/><path d="M20 11v.01"/></svg> },
        { id: 'shower_base', label: 'Shower Base', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><rect width="18" height="18" x="3" y="3" rx="2"/><circle cx="12" cy="12" r="1"/></svg> },
        { id: 'floors', label: 'Floors', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg> },
        { id: 'finishings', label: 'Finishings', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><path d="m14.622 17.897-10.68-2.913"/><path d="M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"/><path d="M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"/></svg> },
        { id: 'structural', label: 'Structural/Other', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M9 12h6"/></svg> },
        { id: 'trades', label: 'Trades', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1.5"><path d="M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5"/><path d="M14 6a6 6 0 0 1 6 6v3"/><path d="M4 15v-3a6 6 0 0 1 6-6"/><rect x="2" y="15" width="20" height="4" rx="1"/></svg> },
    ];

    return (
        <div className="fixed top-0 left-0 right-0 z-20 bg-white/80 backdrop-blur-sm shadow-sm px-4 sm:px-6">
            <div className="max-w-xl mx-auto">
                <div className="tab-scrollbar flex space-x-4 overflow-x-auto py-3">
                    {navItems.map(item => {
                        const isActive = activeView === item.id;
                        const buttonClasses = isActive
                            ? "flex flex-col items-center justify-center w-24 h-20 rounded-xl bg-white text-blue-600 shadow-md border-2 border-blue-500"
                            : "flex flex-col items-center justify-center w-24 h-20 rounded-xl bg-slate-100 text-slate-500 hover:bg-slate-200 transition-colors";

                        return (
                            <button key={item.id} onClick={() => setActiveView(item.id)} className="flex-shrink-0">
                                <div className={buttonClasses}>
                                    {item.icon}
                                    <span className="text-xs font-medium">{item.label}</span>
                                </div>
                            </button>
                        );
                    })}
                </div>
            </div>
        </div>
    );
};

const BottomNavBar = ({ activeView, setActiveView }) => {
    const [isMenuOpen, setIsMenuOpen] = useState(false);
    const menuRef = useRef(null);

    // This maps the main view categories to the detailed views in the top nav
    const designViews = ['demolition', 'shower_walls', 'shower_base', 'floors', 'finishings', 'structural', 'trades'];
    
    // Determine which main category is active
    let activeCategory = activeView;
    if (designViews.includes(activeView)) {
        activeCategory = 'design';
    }

    const handleNavClick = (view) => {
        // If clicking 'Design', go to the last viewed design sub-page or default to 'demolition'
        if (view === 'design') {
            setActiveView(designViews.includes(activeView) ? activeView : 'demolition');
        } else {
            setActiveView(view);
        }
        setIsMenuOpen(false);
    };

    // Close menu when clicking outside
    useEffect(() => {
        const handleClickOutside = (event) => {
            if (menuRef.current && !menuRef.current.contains(event.target)) {
                setIsMenuOpen(false);
            }
        };
        document.addEventListener('mousedown', handleClickOutside);
        return () => {
            document.removeEventListener('mousedown', handleClickOutside);
        };
    }, []);

    const navItems = [
        { id: 'design', label: 'Design', view: 'design', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"/></svg> },
        { id: 'labor', label: 'Labor', view: 'labor', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg> },
        { id: 'supplies', label: 'Materials', view: 'supplies', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg> },
        { id: 'more', label: 'Estimate', view: 'more', icon: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg> },
    ];

    return (
        <div className="fixed bottom-0 left-0 right-0 z-20 bg-white/95 backdrop-blur-sm border-t border-slate-200 safe-area-padding">
            <div className="max-w-xl mx-auto">
                <div className="flex justify-evenly py-2">
                    {navItems.map(item => {
                        const isActive = activeCategory === item.id;
                        const classes = `flex flex-col items-center justify-center w-20 h-16 rounded-xl transition-colors group ${isActive ? 'text-blue-600 bg-blue-100' : 'text-slate-600 hover:bg-slate-100'}`;
                        return (
                            <button key={item.id} onClick={() => handleNavClick(item.view)} className={classes}>
                                {item.icon}
                                <span className="text-xs font-semibold">{item.label}</span>
                            </button>
                        );
                    })}
                    <div className="relative" ref={menuRef}>
                        <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="flex flex-col items-center justify-center w-20 h-16 rounded-xl hover:bg-slate-100 transition-colors group text-slate-600">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 mb-1"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                            <span className="text-xs font-semibold">Menu</span>
                        </button>
                        {isMenuOpen && (
                            <div className="absolute right-0 bottom-full mb-3 w-56 bg-white rounded-xl shadow-lg overflow-hidden z-30">
                                <a href="#" className="flex items-center gap-3 px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 text-slate-500">
                                        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                                        <circle cx="12" cy="13" r="4"></circle>
                                    </svg>
                                    <span>Pictures</span>
                                </a>
                                <a href="#" className="flex items-center gap-3 px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 text-slate-500">
                                         <path d="M12 20h9"></path> 
                                         <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                                     </svg>
                                    <span>Notes</span>
                                </a>
                                <a href="#" className="flex items-center gap-3 px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 text-slate-500">
                                        <line x1="22" y1="2" x2="11" y2="13"></line>
                                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                    </svg>
                                    <span>Send Estimate</span>
                                </a>
                                <a href="#" className="flex items-center gap-3 px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 text-slate-500">
                                        <line x1="18" y1="20" x2="18" y2="10"></line>
                                        <line x1="12" y1="20" x2="12" y2="4"></line>
                                        <line x1="6" y1="20" x2="6" y2="14"></line>
                                    </svg>
                                    <span>Insights</span>
                                </a>
                                <a href="#" className="flex items-center gap-3 px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 text-slate-500">
                                        <circle cx="12" cy="12" r="3"></circle>
                                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                                    </svg>
                                    <span>Settings</span>
                                </a>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        </div>
    );
};


// --- Main App Component ---
const App = () => {
  const [activeView, setActiveView] = useState('supplies');
  
  // State for Demolition View
  const [demolitionChoices, setDemolitionChoices] = useState({
    removeFlooring: 'no',
    removeShowerWall: 'no',
    removeShowerBase: 'no',
    removeTub: 'no',
    removeVanity: 'no',
    removeToilet: 'no',
    removeAccessories: 'no',
    removeWall: 'no',
  });
  const [debrisDisposal, setDebrisDisposal] = useState('no');
  const [isDemolitionFlatFee, setIsDemolitionFlatFee] = useState('no');
  const [flatFeeAmount, setFlatFeeAmount] = useState('');
  const [flatFeeDescription, setFlatFeeDescription] = useState('Demolition Flat Fee');

  // State for Labor and Materials
  const [laborItems, setLaborItems] = useState([]);
  const [flatFeeItems, setFlatFeeItems] = useState([]);
  const [constructionMaterials, setConstructionMaterials] = useState([]);
  
  // State for notes
  const [projectNotes, setProjectNotes] = useState('');
  const [demolitionNotes, setDemolitionNotes] = useState('');

  // --- EFFECT: Manage conditional labor items ---
  useEffect(() => {
    setLaborItems(currentItems => {
        const customItems = currentItems.filter(item => item.id.startsWith('custom-'));
        const demoTasks = [];

        // Demolition tasks
        if (demolitionChoices.removeFlooring === 'yes') demoTasks.push({ id: 'lab-floor', name: `Remove Flooring`, hours: '4', rate: '95' });
        if (demolitionChoices.removeShowerWall === 'yes') demoTasks.push({ id: 'lab-shower-wall', name: 'Remove Shower Wall', hours: '4', rate: '95' });
        if (demolitionChoices.removeShowerBase === 'yes') demoTasks.push({ id: 'lab-shower-base', name: 'Remove Shower Base', hours: '3', rate: '95' });
        if (demolitionChoices.removeTub === 'yes') demoTasks.push({ id: 'lab-tub', name: 'Remove Tub', hours: '2', rate: '95' });
        if (demolitionChoices.removeVanity === 'yes') demoTasks.push({ id: 'lab-vanity', name: 'Remove Vanity', hours: '1.5', rate: '95' });
        if (demolitionChoices.removeToilet === 'yes') demoTasks.push({ id: 'lab-toilet', name: 'Remove Toilet', hours: '0.5', rate: '95' });
        if (demolitionChoices.removeAccessories === 'yes') demoTasks.push({ id: 'lab-accessories', name: 'Remove Accessories', hours: '1', rate: '95' });
        if (demolitionChoices.removeWall === 'yes') demoTasks.push({ id: 'lab-wall', name: 'Remove Wall', hours: '6', rate: '95' });

        return [...demoTasks, ...customItems];
    });
  }, [demolitionChoices]);
  
  // --- EFFECT: Manage the demolition flat fee item ---
  useEffect(() => {
    setFlatFeeItems(currentItems => {
        // Keep all items that are NOT the specific demolition fee
        const otherItems = currentItems.filter(item => item.id !== 'flat-fee-demolition');
        
        if (isDemolitionFlatFee === 'yes') {
            // If flat fee is enabled, add/update our specific demolition fee item
            const demoFeeItem = {
                id: 'flat-fee-demolition',
                name: flatFeeDescription || 'Demolition Flat Fee',
                price: flatFeeAmount || '0'
            };
            return [demoFeeItem, ...otherItems];
        } else {
            // If not enabled, just return the other items, effectively removing the demo fee
            return otherItems;
        }
    });
  }, [isDemolitionFlatFee, flatFeeAmount, flatFeeDescription]);


  // --- EFFECT: Auto-calculate materials based on area and choices ---
  useEffect(() => {
    let newSupplies = [];
    
    const anyDemoSelected = Object.values(demolitionChoices).some(value => value === 'yes');

    if (anyDemoSelected && isDemolitionFlatFee === 'no') {
        newSupplies.push({ id: 'mat-bags', name: 'Heavy-Duty Contractor Bags', quantity: '1', price: '25.00', unit: 'box' });
        newSupplies.push({ id: 'mat-masks', name: 'Dust Masks (N95)', quantity: '1', price: '20.00', unit: 'box' });
        newSupplies.push({ id: 'mat-gloves', name: 'Work Gloves', quantity: '1', price: '15.00', unit: 'pair' });
    }

    if (debrisDisposal === 'yes') {
        newSupplies.push({ id: 'mat-disposal', name: 'Debris Disposal Fee', quantity: '1', price: '350.00', unit: 'trip' });
    }

    setConstructionMaterials(prev => [
        ...newSupplies,
        ...prev.filter(item => item.id.startsWith('custom-supply-'))
    ]);
        
  }, [demolitionChoices, debrisDisposal, isDemolitionFlatFee]);
  
  // --- Labor Handlers ---
  const handleAddLaborItem = () => {
    setLaborItems(prev => [...prev, { id: `custom-${Date.now()}`, name: 'Custom Demolition Task', hours: '1', rate: '95' }]);
    setActiveView('labor');
  };

  const handleDeleteLaborItem = (id) => {
      setLaborItems(prev => prev.filter(item => item.id !== id));
  };

  const handleLaborItemChange = (id, field, value) => {
      setLaborItems(prev => prev.map(item => item.id === id ? { ...item, [field]: value } : item));
  };

  // --- Flat Fee Handlers ---
  const handleAddFlatFeeItem = () => {
    setFlatFeeItems(prev => [...prev, { id: `flat-${Date.now()}`, name: 'Custom Flat Fee Task', price: '' }]);
  };

  const handleDeleteFlatFeeItem = (id) => {
    // Prevent deleting the auto-generated demolition fee
    if (id === 'flat-fee-demolition') return;
    setFlatFeeItems(prev => prev.filter(item => item.id !== id));
  };

  const handleFlatFeeItemChange = (id, field, value) => {
    // If the user is editing the auto-generated demolition fee, update the master state instead
    if (id === 'flat-fee-demolition' && field === 'price') {
        setFlatFeeAmount(value);
    } else if (id === 'flat-fee-demolition' && field === 'name') {
        setFlatFeeDescription(value);
    } else {
        setFlatFeeItems(prev => prev.map(item => item.id === id ? { ...item, [field]: value } : item));
    }
  };
  
  const handleDeleteSupply = (id) => {
    setConstructionMaterials(prev => prev.filter(item => item.id !== id));
  };
  
  // --- CALCULATE TOTALS ---
  const flatFeeTotal = flatFeeItems.reduce((sum, item) => sum + (parseFloat(item.price) || 0), 0);
  const hourlyLaborTotal = laborItems.reduce((sum, item) => sum + (parseFloat(item.hours) || 0) * (parseFloat(item.rate) || 0), 0);
  const laborTotal = isDemolitionFlatFee === 'yes' ? flatFeeTotal : hourlyLaborTotal;
  const suppliesTotal = constructionMaterials.reduce((sum, item) => sum + (parseFloat(item.quantity) || 0) * (parseFloat(item.price) || 0), 0);
  const grandTotal = laborTotal + suppliesTotal;

  // --- View Renderer ---
  const renderActiveView = () => {
      switch(activeView) {
          case 'demolition':
          case 'shower_walls':
          case 'shower_base':
          case 'floors':
          case 'finishings':
          case 'structural':
          case 'trades':
              // This is a simplified router. For a real app, you'd use a library.
              if (activeView === 'demolition') return <DemolitionView 
                  demolitionChoices={demolitionChoices}
                  setDemolitionChoices={setDemolitionChoices}
                  debrisDisposal={debrisDisposal}
                  setDebrisDisposal={setDebrisDisposal}
                  isDemolitionFlatFee={isDemolitionFlatFee}
                  setIsDemolitionFlatFee={setIsDemolitionFlatFee}
                  flatFeeAmount={flatFeeAmount}
                  setFlatFeeAmount={setFlatFeeAmount}
                  flatFeeDescription={flatFeeDescription}
                  setFlatFeeDescription={setFlatFeeDescription}
                  handleAddLaborItem={handleAddLaborItem}
                  demolitionNotes={demolitionNotes}
                  setDemolitionNotes={setDemolitionNotes}
              />;
              if (activeView === 'shower_walls') return <ShowerWallsView />;
              if (activeView === 'shower_base') return <ShowerBaseView />;
              if (activeView === 'floors') return <FloorsView />;
              if (activeView === 'finishings') return <FinishingsView />;
              if (activeView === 'structural') return <StructuralView />;
              if (activeView === 'trades') return <TradesView />;
              break;
          case 'labor':
              return <LaborView 
                  laborItems={laborItems} 
                  setLaborItems={setLaborItems}
                  flatFeeItems={flatFeeItems}
                  setFlatFeeItems={setFlatFeeItems}
                  handleAddLaborItem={handleAddLaborItem}
                  handleLaborItemChange={handleLaborItemChange}
                  handleDeleteLaborItem={handleDeleteLaborItem}
                  handleAddFlatFeeItem={handleAddFlatFeeItem}
                  handleFlatFeeItemChange={handleFlatFeeItemChange}
                  handleDeleteFlatFeeItem={handleDeleteFlatFeeItem}
                  isDemolitionFlatFee={isDemolitionFlatFee}
              />;
          case 'supplies':
              return <SuppliesView 
                  constructionMaterials={constructionMaterials}
                  setConstructionMaterials={setConstructionMaterials}
                  handleDeleteSupply={handleDeleteSupply}
              />;
          case 'more':
              return <MoreView 
                  total={grandTotal}
                  notes={projectNotes}
                  setNotes={setProjectNotes}
              />;
          default:
              return <DemolitionView 
                  demolitionChoices={demolitionChoices}
                  setDemolitionChoices={setDemolitionChoices}
                  debrisDisposal={debrisDisposal}
                  setDebrisDisposal={setDebrisDisposal}
                  isDemolitionFlatFee={isDemolitionFlatFee}
                  setIsDemolitionFlatFee={setIsDemolitionFlatFee}
                  flatFeeAmount={flatFeeAmount}
                  setFlatFeeAmount={setFlatFeeAmount}
                  flatFeeDescription={flatFeeDescription}
                  setFlatFeeDescription={setFlatFeeDescription}
                  handleAddLaborItem={handleAddLaborItem}
                  demolitionNotes={demolitionNotes}
                  setDemolitionNotes={setDemolitionNotes}
              />;
      }
  }

  return (
    <div className="min-h-screen bg-slate-100 font-sans">
      <TopNavBar activeView={activeView} setActiveView={setActiveView} />
      
      <main className="w-full max-w-lg mx-auto pt-32 pb-28 px-4">
        {activeView === 'demolition' ? (
          renderActiveView()
        ) : (
          <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div className="p-6 pb-6">
                {renderActiveView()}
            </div>
          </div>
        )}
      </main>

      <BottomNavBar activeView={activeView} setActiveView={setActiveView} />

      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .tab-scrollbar::-webkit-scrollbar { height: 4px; }
        .tab-scrollbar::-webkit-scrollbar-thumb { background-color: #e2e8f0; border-radius: 10px; }
        .tab-scrollbar::-webkit-scrollbar-track { background: transparent; }
        
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
          -webkit-appearance: none; 
          margin: 0; 
        }
        input[type=number] { -moz-appearance: textfield; }
        
        .safe-area-padding {
            padding-bottom: env(safe-area-inset-bottom);
        }
      `}</style>
    </div>
  );
};

export default App;

